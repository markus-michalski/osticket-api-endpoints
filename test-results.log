
[0;34m===================================================================[0m
[0;34m  1. LEGACY ENDPOINTS - tickets-get.php[0m
[0;34m===================================================================[0m

[0;32m[TEST][0m 1.1 Get Ticket Details (JSON)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-get.php/456846.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | jq .

[1;33mResponse:[0m
{
  "id": 22,
  "number": "456846",
  "subject": "Plugin: Custom CSS Loader",
  "statusId": 1,
  "status": "Offen",
  "priorityId": 2,
  "priority": "Normal",
  "departmentId": 9,
  "department": "osTicket",
  "topicId": 1,
  "topic": "Feature",
  "userId": 3,
  "user": {
    "name": {
      "format": "original",
      "parts": {
        "salutation": "",
        "first": "MM",
        "suffix": "",
        "last": "Standard",
        "middle": "-"
      },
      "name": "MM - Standard"
    },
    "email": {
      "email": "info@markus-michalski.net",
      "address": "\"MM - Standard\" <info@markus-michalski.net>"
    }
  },
  "staffId": 1,
  "staff": {
    "format": "full",
    "parts": {
      "first": "Markus",
      "last": "Michalski"
    },
    "name": "Markus Michalski"
  },
  "teamId": null,
  "team": null,
  "slaId": 1,
  "sla": "Standard-SLA",
  "created": "2025-10-19 21:34:44",
  "updated": "2025-10-22 15:04:07",
  "duedate": "2025-11-30 14:04:00",
  "closed": null,
  "isOverdue": 0,
  "isAnswered": 0,
  "source": "API",
  "ip": "79.225.190.175",
  "children": [],
  "thread": [
    {
      "id": 34,
      "type": "M",
      "poster": "Markus Michalski",
      "timestamp": "2025-10-19 21:34:44",
      "body": {
        "body": "<h2>Ziel</h2>\n  <p>Entwicklung eines osTicket-Plugins, das automatisch Custom\n  CSS-Dateien aus dem Verzeichnis <code>assets/custom/css/</code>\n  lÃ¤dt und basierend auf dem Dateinamen entweder im Admin Panel\n  (Staff) oder Client Portal einbindet.</p>\n\n  <hr>\n\n  <h2>Funktionsweise</h2>\n\n  <h3>Automatische CSS-Einbindung</h3>\n  <ul>\n    <li><strong>Verzeichnis:</strong>\n  <code>assets/custom/css/</code> (wird vom Plugin angelegt, falls\n   nicht vorhanden)</li>\n    <li><strong>Dateinamens-Konvention:</strong>\n      <ul>\n        <li>Dateiname enthÃ¤lt <code>client</code> â†’ Einbindung im\n  <strong>Client Portal</strong> (Frontend)</li>\n        <li>Dateiname enthÃ¤lt <code>staff</code> â†’ Einbindung im\n  <strong>Admin Panel</strong> (Staff Control Panel)</li>\n      </ul>\n    </li>\n    <li><strong>Beispiele:</strong>\n      <ul>\n        <li><code>custom-client-styles.css</code> â†’ Client\n  Portal</li>\n        <li><code>staff-branding.css</code> â†’ Admin Panel</li>\n        <li><code>client-theme.css</code> â†’ Client Portal</li>\n        <li><code>my-staff-colors.css</code> â†’ Admin Panel</li>\n      </ul>\n    </li>\n  </ul>\n\n  <hr>\n\n  <h2>Technische Anforderungen</h2>\n\n  <h3>Plugin-Features</h3>\n  <ul>\n    <li><strong>Ordner-Erstellung:</strong> Plugin erstellt\n  <code>assets/custom/css/</code> bei Aktivierung</li>\n    <li><strong>Dynamisches Scannen:</strong> Alle\n  <code>*.css</code> Dateien im Ordner werden gescannt</li>\n    <li><strong>Automatische Einbindung:</strong> Via\n  <code>&lt;link&gt;</code> Tags im HTML\n  <code>&lt;head&gt;</code></li>\n    <li><strong>Cache-Busting:</strong> File Modification Time als\n   Query-Parameter (<code>?v=1234567890</code>)</li>\n    <li><strong>Fehlerbehandlung:</strong> Graceful fallback bei\n  fehlenden/ungÃ¼ltigen Dateien</li>\n  </ul>\n\n  <h3>Signal-Hooks</h3>\n  <ul>\n    <li><strong>Staff Control Panel:</strong> Nutze\n  <code>$ost-&gt;addExtraHeader()</code> Methode</li>\n    <li><strong>Client Portal:</strong> Nutze\n  <code>$ost-&gt;addExtraHeader()</code> Methode</li>\n    <li><strong>Hook-Point:</strong> Plugin bootstrap() oder\n  Signal::connect('apps.scp')</li>\n  </ul>\n\n  <hr>\n\n  <h2>Implementation</h2>\n\n  <h3>Plugin-Struktur</h3>\n  <pre>\n  include/plugins/custom-css-loader/\n  â”œâ”€â”€ plugin.php                    # Plugin-Metadaten\n  â”œâ”€â”€ class.CustomCssLoader.php     # Haupt-Plugin-Klasse\n  â”œâ”€â”€ config.php                    # Optional:\n  Konfigurationsoptionen\n  â””â”€â”€ README.md                     # Dokumentation\n  </pre>\n\n  <h3>Code-Beispiel (Pseudo-Code)</h3>\n  <pre>\n  class CustomCssLoaderPlugin extends Plugin {\n\n      function bootstrap() {\n          // CSS-Verzeichnis sicherstellen\n          $this->ensureCssDirectory();\n\n          // CSS fÃ¼r Staff Panel laden\n          Signal::connect('apps.scp', array($this,\n  'loadStaffCss'));\n\n          // CSS fÃ¼r Client Portal laden\n          // (Alternative: direkt in header.inc.php oder via\n  bootstrap)\n          $this->loadClientCss();\n      }\n\n      function ensureCssDirectory() {\n          $cssDir = ROOT_PATH . 'assets/custom/css/';\n          if (!is_dir($cssDir)) {\n              mkdir($cssDir, 0755, true);\n          }\n      }\n\n      function loadStaffCss($obj = null) {\n          $cssDir = ROOT_PATH . 'assets/custom/css/';\n          $cssFiles = glob($cssDir . '*staff*.css');\n\n          foreach ($cssFiles as $file) {\n              $version = filemtime($file); // Cache busting\n              $url = ROOT_PATH . 'assets/custom/css/' .\n  basename($file);\n              $ost-&gt;addExtraHeader(\n                  sprintf('&lt;link rel=\"stylesheet\"\n  href=\"%s?v=%s\" /&gt;', $url, $version)\n              );\n          }\n      }\n\n      function loadClientCss() {\n          $cssDir = ROOT_PATH . 'assets/custom/css/';\n          $cssFiles = glob($cssDir . '*client*.css');\n\n          foreach ($cssFiles as $file) {\n              $version = filemtime($file);\n              $url = ROOT_PATH . 'assets/custom/css/' .\n  basename($file);\n              $ost-&gt;addExtraHeader(\n                  sprintf('&lt;link rel=\"stylesheet\"\n  href=\"%s?v=%s\" /&gt;', $url, $version)\n              );\n          }\n      }\n  }\n  </pre>\n\n  <hr>\n\n  <h2>Referenz: Bestehendes Custom CSS</h2>\n\n  <p><strong>Repository:</strong>\n  <code>/home/markus/projekte/osticket-customizations</code></p>\n\n  <p><strong>Bestehende CSS-Dateien (als Vorlage):</strong></p>\n  <ul>\n    <li><code>scripts/user-styles.css</code> â†’ Umbenennen zu\n  <code>staff-branding.css</code></li>\n    <li><code>scripts/client-styles.css</code> â†’ Umbenennen zu\n  <code>client-branding.css</code></li>\n  </ul>\n\n  <p><strong>Aktuelles Branding (MLM Gallery):</strong></p>\n  <pre>\n  --primary: #1E3A5F;       /* blue-700 */\n  --neutral-warm: #EAE6DF;  /* warm beige */\n  --neutral-gray: #CFCBCC;  /* warm gray */\n  --neutral-dark: #2C2B29;  /* dark gray */\n  </pre>\n\n  <hr>\n\n  <h2>Deliverables</h2>\n  <ol>\n    <li>Plugin-Code mit automatischem CSS-Loading</li>\n    <li>Ordner-Erstellung bei Plugin-Aktivierung</li>\n    <li>Cache-Busting Mechanismus</li>\n    <li>Error-Handling &amp; Logging</li>\n    <li>Dokumentation (README.md)</li>\n    <li>Installation Guide</li>\n  </ol>\n\n  <hr>\n\n  <h2>Akzeptanzkriterien</h2>\n  <ul>\n    <li>[ ] Plugin erstellt <code>assets/custom/css/</code>\n  automatisch</li>\n    <li>[ ] Dateien mit <code>staff</code> im Namen werden im\n  Admin Panel geladen</li>\n    <li>[ ] Dateien mit <code>client</code> im Namen werden im\n  Client Portal geladen</li>\n    <li>[ ] Cache-Busting funktioniert (Browser-Cache-Update bei\n  Ã„nderungen)</li>\n    <li>[ ] Keine Errors bei leerem Verzeichnis</li>\n    <li>[ ] Plugin aktivierbar/deaktivierbar</li>\n    <li>[ ] Kompatibel mit osTicket 1.18.x</li>\n  </ul>\n\n  <hr>\n\n  <h2>Bonus-Features (Optional)</h2>\n  <ul>\n    <li>[ ] Admin-Panel: Liste aller geladenen CSS-Dateien\n  anzeigen</li>\n    <li>[ ] CSS-Editor im Admin-Panel (direkt bearbeiten)</li>\n    <li>[ ] SCSS/SASS-Kompilierung on-the-fly</li>\n    <li>[ ] CSS-Minification</li>\n    <li>[ ] Mehrere Ordner unterstÃ¼tzen\n  (<code>assets/custom/css/staff/</code>,\n  <code>assets/custom/css/client/</code>)</li>\n  </ul>\n\n  <hr>\n\n  <h2>Technologie-Stack</h2>\n  <ul>\n    <li>osTicket Plugin API</li>\n    <li>PHP File I/O (<code>glob()</code>,\n  <code>filemtime()</code>, <code>mkdir()</code>)</li>\n    <li><code>$ost-&gt;addExtraHeader()</code> Methode</li>\n    <li>CSS3</li>\n  </ul>\n\n  <hr>\n\n  <h2>Technische Implementation Details (Code-Analyse)</h2>\n\n  <h3>1. Header-Injection Mechanismus</h3>\n\n  <p><strong>osTicket bietet <code>addExtraHeader()</code>\n  Methode:</strong></p>\n\n  <p><strong>Klasse:</strong>\n  <code>/include/class.osticket.php</code> (Zeilen 157-167)</p>\n\n  <pre>\n  // Zeile 157\n  function addExtraHeader($header, $pjax_script=false) {\n      $this-&gt;headers[md5($header)] = $header;\n      $this-&gt;pjax_extra[md5($header)] = $pjax_script;\n  }\n\n  // Zeile 162\n  function getExtraHeaders() {\n      return $this-&gt;headers;\n  }\n  </pre>\n\n  <p><strong>Verwendung in header.inc.php:</strong></p>\n\n  <ul>\n    <li><strong>Staff Header:</strong>\n  <code>/include/staff/header.inc.php</code> (Zeilen 58-60)</li>\n    <li><strong>Client Header:</strong>\n  <code>/include/client/header.inc.php</code> (Zeilen 66-68)</li>\n  </ul>\n\n  <pre>\n  // Beide Header-Dateien verwenden:\n  &lt;?php\n  if($ost &amp;&amp; ($headers=$ost-&gt;getExtraHeaders())) {\n      echo \"\\n\\t\".implode(\"\\n\\t\", $headers).\"\\n\";\n  }\n  ?&gt;\n  </pre>\n\n  <p><strong>Injection erfolgt INNERHALB des\n  <code>&lt;head&gt;</code> Tags!</strong></p>\n\n  <hr>\n\n  <h3>2. Signal-Hooks fÃ¼r Context-Detection</h3>\n\n  <p><strong>VerfÃ¼gbare Signals:</strong></p>\n\n  <ul>\n    <li><strong>Staff Control Panel:</strong>\n      <ul>\n        <li><code>Signal::send('apps.scp', $dispatcher)</code> in\n  <code>/scp/apps/dispatcher.php:39</code></li>\n      </ul>\n    </li>\n    <li><strong>Client Portal:</strong>\n      <ul>\n        <li><code>Signal::send('ajax.client', $dispatcher)</code>\n  in <code>/ajax.php:50</code></li>\n        <li>Alternativ: Bootstrap-Check auf\n  <code>OSTCLIENTINC</code> define</li>\n      </ul>\n    </li>\n  </ul>\n\n  <p><strong>Empfohlene Implementation:</strong></p>\n\n  <pre>\n  class CustomCssLoaderPlugin extends Plugin {\n\n      function bootstrap() {\n          global $ost;\n\n          // Ordner erstellen\n          $this-&gt;ensureCssDirectory();\n\n          // CSS fÃ¼r Staff Panel\n          Signal::connect('apps.scp', function() use ($ost) {\n              $this-&gt;injectCss('staff', $ost);\n          });\n\n          // CSS fÃ¼r Client Portal (via define-Check)\n          if (defined('OSTCLIENTINC')) {\n              $this-&gt;injectCss('client', $ost);\n          }\n      }\n\n      function injectCss($context, $ost) {\n          $cssDir = ROOT_PATH . 'assets/custom/css/';\n          $pattern = $cssDir . '*' . $context . '*.css';\n          $cssFiles = glob($pattern);\n\n          if (!$cssFiles) return; // Guard: keine Dateien\n\n          foreach ($cssFiles as $file) {\n              $version = filemtime($file);\n              $url = ROOT_PATH . 'assets/custom/css/' .\n  basename($file);\n              $ost-&gt;addExtraHeader(\n                  sprintf('&lt;link rel=\"stylesheet\"\n  href=\"%s?v=%s\" /&gt;',\n                      $url, $version)\n              );\n          }\n      }\n  }\n  </pre>\n\n  <hr>\n\n  <h3>3. Ordner-Struktur &amp; Berechtigungen</h3>\n\n  <p><strong>Ordner-Erstellung:</strong></p>\n\n  <pre>\n  function ensureCssDirectory() {\n      $cssDir = ROOT_PATH . 'assets/custom/css/';\n\n      if (!is_dir($cssDir)) {\n          if (!mkdir($cssDir, 0755, true)) {\n              error_log('CustomCssLoader: Failed to create\n  directory ' . $cssDir);\n              return false;\n          }\n      }\n\n      // Optional: .htaccess fÃ¼r direkten CSS-Zugriff\n      $htaccess = $cssDir . '.htaccess';\n      if (!file_exists($htaccess)) {\n          file_put_contents($htaccess, \"Allow from all\\n\");\n      }\n\n      return true;\n  }\n  </pre>\n\n  <p><strong>Wichtig:</strong> Ordner\n  <code>assets/custom/css/</code> muss vom Webserver lesbar\n  sein!</p>\n\n  <hr>\n\n  <h3>4. Dateinamen-Pattern Matching</h3>\n\n  <p><strong>Verwendete PHP-Funktionen:</strong></p>\n\n  <ul>\n    <li><code>glob($pattern)</code> - Findet alle Dateien nach\n  Muster</li>\n    <li><code>filemtime($file)</code> - Modification Time fÃ¼r\n  Cache-Busting</li>\n    <li><code>basename($file)</code> - Dateiname ohne Pfad</li>\n  </ul>\n\n  <p><strong>Pattern-Beispiele:</strong></p>\n\n  <pre>\n  // Alle Staff-CSS-Dateien\n  glob('assets/custom/css/*staff*.css')\n  â†’ staff-branding.css, my-staff-theme.css, custom-staff.css\n\n  // Alle Client-CSS-Dateien\n  glob('assets/custom/css/*client*.css')\n  â†’ client-styles.css, my-client-theme.css, custom-client.css\n\n  // Alle CSS-Dateien (fÃ¼r Admin-Ãœbersicht)\n  glob('assets/custom/css/*.css')\n  </pre>\n\n  <hr>\n\n  <h3>5. Cache-Busting Strategie</h3>\n\n  <p><strong>Methode 1: File Modification Time\n  (empfohlen)</strong></p>\n\n  <pre>\n  $version = filemtime($file); // Unix Timestamp\n  $url = sprintf('%s?v=%d', $cssUrl, $version);\n  // Beispiel: assets/custom/css/staff-theme.css?v=1738261234\n  </pre>\n\n  <p><strong>Methode 2: MD5 Hash (alternative)</strong></p>\n\n  <pre>\n  $hash = md5_file($file);\n  $url = sprintf('%s?v=%s', $cssUrl, substr($hash, 0, 8));\n  // Beispiel: assets/custom/css/staff-theme.css?v=a3f2c1d4\n  </pre>\n\n  <p><strong>Browser-Verhalten:</strong></p>\n  <ul>\n    <li>Ã„ndert sich <code>?v=</code> Parameter â†’ Browser lÃ¤dt\n  Datei neu</li>\n    <li>Gleicher Parameter â†’ Browser nutzt Cache</li>\n  </ul>\n\n  <hr>\n\n  <h3>6. Error Handling &amp; Logging</h3>\n\n  <pre>\n  function injectCss($context, $ost) {\n      try {\n          $cssDir = ROOT_PATH . 'assets/custom/css/';\n\n          // Guard: Verzeichnis existiert nicht\n          if (!is_dir($cssDir)) {\n              error_log(\"CustomCssLoader: Directory not found:\n  $cssDir\");\n              return;\n          }\n\n          // Guard: Keine Leserechte\n          if (!is_readable($cssDir)) {\n              error_log(\"CustomCssLoader: Directory not readable:\n  $cssDir\");\n              return;\n          }\n\n          $cssFiles = glob($cssDir . '*' . $context . '*.css');\n\n          // Guard: Keine Dateien gefunden (kein Error - einfach\n  nichts tun)\n          if (!$cssFiles) return;\n\n          foreach ($cssFiles as $file) {\n              // Guard: Datei nicht lesbar\n              if (!is_readable($file)) {\n                  error_log(\"CustomCssLoader: File not readable:\n  $file\");\n                  continue;\n              }\n\n              $version = filemtime($file);\n              $url = ROOT_PATH . 'assets/custom/css/' .\n  basename($file);\n              $ost-&gt;addExtraHeader(\n                  sprintf('&lt;link rel=\"stylesheet\"\n  href=\"%s?v=%s\" /&gt;', $url, $version)\n              );\n          }\n      } catch (Exception $e) {\n          error_log(\"CustomCssLoader Exception: \" .\n  $e-&gt;getMessage());\n      }\n  }\n  </pre>\n\n  <hr>\n\n  <h3>7. Plugin-Installation Workflow</h3>\n\n  <ol>\n    <li><strong>Plugin installieren:</strong> Ordner nach\n  <code>include/plugins/custom-css-loader/</code> kopieren</li>\n    <li><strong>Plugin aktivieren:</strong> Admin Panel â†’ Manage â†’\n   Plugins â†’ \"Custom CSS Loader\" aktivieren</li>\n    <li><strong>Ordner wird erstellt:</strong>\n  <code>assets/custom/css/</code> entsteht automatisch</li>\n    <li><strong>CSS-Dateien hinzufÃ¼gen:</strong>\n      <ul>\n        <li>Kopiere <code>staff-branding.css</code> nach\n  <code>assets/custom/css/</code></li>\n        <li>Kopiere <code>client-branding.css</code> nach\n  <code>assets/custom/css/</code></li>\n      </ul>\n    </li>\n    <li><strong>Browser-Reload:</strong> CSS wird automatisch\n  geladen!</li>\n  </ol>\n\n  <hr>\n\n  <h3>8. Testing-Checkliste</h3>\n\n  <ul>\n    <li>[ ] Plugin aktivieren â†’ <code>assets/custom/css/</code>\n  Ordner wird erstellt</li>\n    <li>[ ] <code>staff-test.css</code> in Ordner legen â†’ Im Admin\n   Panel <code>&lt;head&gt;</code> sichtbar</li>\n    <li>[ ] <code>client-test.css</code> in Ordner legen â†’ Im\n  Client Portal <code>&lt;head&gt;</code> sichtbar</li>\n    <li>[ ] CSS-Datei Ã¤ndern â†’ Cache-Busting Parameter Ã¤ndert\n  sich</li>\n    <li>[ ] Leerer Ordner â†’ Keine Fehler im Log</li>\n    <li>[ ] Plugin deaktivieren â†’ CSS wird NICHT mehr geladen</li>\n    <li>[ ] UngÃ¼ltige Datei (keine .css) â†’ Wird ignoriert</li>\n    <li>[ ] Browser DevTools: CSS wird korrekt angewendet</li>\n  </ul>\n\n  <hr>\n\n  <p><em>Recherchiert in:</em>\n  <code>/home/markus/projekte/osTicket</code> (osTicket\n  1.18.1)</p>",
        "type": "html",
        "stripped_images": [],
        "embedded_images": [],
        "options": {
          "strip-embedded": false,
          "balanced": false
        }
      }
    }
  ]
}


[0;32m[TEST][0m 1.2 Get Ticket Details (XML)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-get.php/456846.xml"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s

[1;33mResponse:[0m
<?xml version="1.0"?>
<ticket><id>22</id><number>456846</number><subject>Plugin: Custom CSS Loader</subject><statusId>1</statusId><status>Offen</status><priorityId>2</priorityId><priority>Normal</priority><departmentId>9</departmentId><department>osTicket</department><topicId>1</topicId><topic>Feature</topic><userId>3</userId><user><name>MM - Standard</name><email>info@markus-michalski.net</email></user><staffId>1</staffId><staff>Markus Michalski</staff><teamId/><team/><slaId>1</slaId><sla>Standard-SLA</sla><created>2025-10-19 21:34:44</created><updated>2025-10-22 15:04:07</updated><duedate>2025-11-30 14:04:00</duedate><closed/><isOverdue>0</isOverdue><isAnswered>0</isAnswered><source>API</source><ip>79.225.190.175</ip><children/><thread><item><id>34</id><type>M</type><poster>Markus Michalski</poster><timestamp>2025-10-19 21:34:44</timestamp><body>&lt;h2&gt;Ziel&lt;/h2&gt;
  &lt;p&gt;Entwicklung eines osTicket-Plugins, das automatisch Custom
  CSS-Dateien aus dem Verzeichnis &lt;code&gt;assets/custom/css/&lt;/code&gt;
  l&#xE4;dt und basierend auf dem Dateinamen entweder im Admin Panel
  (Staff) oder Client Portal einbindet.&lt;/p&gt;

  &lt;hr&gt;

  &lt;h2&gt;Funktionsweise&lt;/h2&gt;

  &lt;h3&gt;Automatische CSS-Einbindung&lt;/h3&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;Verzeichnis:&lt;/strong&gt;
  &lt;code&gt;assets/custom/css/&lt;/code&gt; (wird vom Plugin angelegt, falls
   nicht vorhanden)&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Dateinamens-Konvention:&lt;/strong&gt;
      &lt;ul&gt;
        &lt;li&gt;Dateiname enth&#xE4;lt &lt;code&gt;client&lt;/code&gt; &#x2192; Einbindung im
  &lt;strong&gt;Client Portal&lt;/strong&gt; (Frontend)&lt;/li&gt;
        &lt;li&gt;Dateiname enth&#xE4;lt &lt;code&gt;staff&lt;/code&gt; &#x2192; Einbindung im
  &lt;strong&gt;Admin Panel&lt;/strong&gt; (Staff Control Panel)&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Beispiele:&lt;/strong&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;code&gt;custom-client-styles.css&lt;/code&gt; &#x2192; Client
  Portal&lt;/li&gt;
        &lt;li&gt;&lt;code&gt;staff-branding.css&lt;/code&gt; &#x2192; Admin Panel&lt;/li&gt;
        &lt;li&gt;&lt;code&gt;client-theme.css&lt;/code&gt; &#x2192; Client Portal&lt;/li&gt;
        &lt;li&gt;&lt;code&gt;my-staff-colors.css&lt;/code&gt; &#x2192; Admin Panel&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;

  &lt;hr&gt;

  &lt;h2&gt;Technische Anforderungen&lt;/h2&gt;

  &lt;h3&gt;Plugin-Features&lt;/h3&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;Ordner-Erstellung:&lt;/strong&gt; Plugin erstellt
  &lt;code&gt;assets/custom/css/&lt;/code&gt; bei Aktivierung&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Dynamisches Scannen:&lt;/strong&gt; Alle
  &lt;code&gt;*.css&lt;/code&gt; Dateien im Ordner werden gescannt&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Automatische Einbindung:&lt;/strong&gt; Via
  &lt;code&gt;&amp;lt;link&amp;gt;&lt;/code&gt; Tags im HTML
  &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Cache-Busting:&lt;/strong&gt; File Modification Time als
   Query-Parameter (&lt;code&gt;?v=1234567890&lt;/code&gt;)&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Fehlerbehandlung:&lt;/strong&gt; Graceful fallback bei
  fehlenden/ung&#xFC;ltigen Dateien&lt;/li&gt;
  &lt;/ul&gt;

  &lt;h3&gt;Signal-Hooks&lt;/h3&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;Staff Control Panel:&lt;/strong&gt; Nutze
  &lt;code&gt;$ost-&amp;gt;addExtraHeader()&lt;/code&gt; Methode&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Client Portal:&lt;/strong&gt; Nutze
  &lt;code&gt;$ost-&amp;gt;addExtraHeader()&lt;/code&gt; Methode&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Hook-Point:&lt;/strong&gt; Plugin bootstrap() oder
  Signal::connect('apps.scp')&lt;/li&gt;
  &lt;/ul&gt;

  &lt;hr&gt;

  &lt;h2&gt;Implementation&lt;/h2&gt;

  &lt;h3&gt;Plugin-Struktur&lt;/h3&gt;
  &lt;pre&gt;
  include/plugins/custom-css-loader/
  &#x251C;&#x2500;&#x2500; plugin.php                    # Plugin-Metadaten
  &#x251C;&#x2500;&#x2500; class.CustomCssLoader.php     # Haupt-Plugin-Klasse
  &#x251C;&#x2500;&#x2500; config.php                    # Optional:
  Konfigurationsoptionen
  &#x2514;&#x2500;&#x2500; README.md                     # Dokumentation
  &lt;/pre&gt;

  &lt;h3&gt;Code-Beispiel (Pseudo-Code)&lt;/h3&gt;
  &lt;pre&gt;
  class CustomCssLoaderPlugin extends Plugin {

      function bootstrap() {
          // CSS-Verzeichnis sicherstellen
          $this-&gt;ensureCssDirectory();

          // CSS f&#xFC;r Staff Panel laden
          Signal::connect('apps.scp', array($this,
  'loadStaffCss'));

          // CSS f&#xFC;r Client Portal laden
          // (Alternative: direkt in header.inc.php oder via
  bootstrap)
          $this-&gt;loadClientCss();
      }

      function ensureCssDirectory() {
          $cssDir = ROOT_PATH . 'assets/custom/css/';
          if (!is_dir($cssDir)) {
              mkdir($cssDir, 0755, true);
          }
      }

      function loadStaffCss($obj = null) {
          $cssDir = ROOT_PATH . 'assets/custom/css/';
          $cssFiles = glob($cssDir . '*staff*.css');

          foreach ($cssFiles as $file) {
              $version = filemtime($file); // Cache busting
              $url = ROOT_PATH . 'assets/custom/css/' .
  basename($file);
              $ost-&amp;gt;addExtraHeader(
                  sprintf('&amp;lt;link rel="stylesheet"
  href="%s?v=%s" /&amp;gt;', $url, $version)
              );
          }
      }

      function loadClientCss() {
          $cssDir = ROOT_PATH . 'assets/custom/css/';
          $cssFiles = glob($cssDir . '*client*.css');

          foreach ($cssFiles as $file) {
              $version = filemtime($file);
              $url = ROOT_PATH . 'assets/custom/css/' .
  basename($file);
              $ost-&amp;gt;addExtraHeader(
                  sprintf('&amp;lt;link rel="stylesheet"
  href="%s?v=%s" /&amp;gt;', $url, $version)
              );
          }
      }
  }
  &lt;/pre&gt;

  &lt;hr&gt;

  &lt;h2&gt;Referenz: Bestehendes Custom CSS&lt;/h2&gt;

  &lt;p&gt;&lt;strong&gt;Repository:&lt;/strong&gt;
  &lt;code&gt;/home/markus/projekte/osticket-customizations&lt;/code&gt;&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;Bestehende CSS-Dateien (als Vorlage):&lt;/strong&gt;&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;&lt;code&gt;scripts/user-styles.css&lt;/code&gt; &#x2192; Umbenennen zu
  &lt;code&gt;staff-branding.css&lt;/code&gt;&lt;/li&gt;
    &lt;li&gt;&lt;code&gt;scripts/client-styles.css&lt;/code&gt; &#x2192; Umbenennen zu
  &lt;code&gt;client-branding.css&lt;/code&gt;&lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;&lt;strong&gt;Aktuelles Branding (MLM Gallery):&lt;/strong&gt;&lt;/p&gt;
  &lt;pre&gt;
  --primary: #1E3A5F;       /* blue-700 */
  --neutral-warm: #EAE6DF;  /* warm beige */
  --neutral-gray: #CFCBCC;  /* warm gray */
  --neutral-dark: #2C2B29;  /* dark gray */
  &lt;/pre&gt;

  &lt;hr&gt;

  &lt;h2&gt;Deliverables&lt;/h2&gt;
  &lt;ol&gt;
    &lt;li&gt;Plugin-Code mit automatischem CSS-Loading&lt;/li&gt;
    &lt;li&gt;Ordner-Erstellung bei Plugin-Aktivierung&lt;/li&gt;
    &lt;li&gt;Cache-Busting Mechanismus&lt;/li&gt;
    &lt;li&gt;Error-Handling &amp;amp; Logging&lt;/li&gt;
    &lt;li&gt;Dokumentation (README.md)&lt;/li&gt;
    &lt;li&gt;Installation Guide&lt;/li&gt;
  &lt;/ol&gt;

  &lt;hr&gt;

  &lt;h2&gt;Akzeptanzkriterien&lt;/h2&gt;
  &lt;ul&gt;
    &lt;li&gt;[ ] Plugin erstellt &lt;code&gt;assets/custom/css/&lt;/code&gt;
  automatisch&lt;/li&gt;
    &lt;li&gt;[ ] Dateien mit &lt;code&gt;staff&lt;/code&gt; im Namen werden im
  Admin Panel geladen&lt;/li&gt;
    &lt;li&gt;[ ] Dateien mit &lt;code&gt;client&lt;/code&gt; im Namen werden im
  Client Portal geladen&lt;/li&gt;
    &lt;li&gt;[ ] Cache-Busting funktioniert (Browser-Cache-Update bei
  &#xC4;nderungen)&lt;/li&gt;
    &lt;li&gt;[ ] Keine Errors bei leerem Verzeichnis&lt;/li&gt;
    &lt;li&gt;[ ] Plugin aktivierbar/deaktivierbar&lt;/li&gt;
    &lt;li&gt;[ ] Kompatibel mit osTicket 1.18.x&lt;/li&gt;
  &lt;/ul&gt;

  &lt;hr&gt;

  &lt;h2&gt;Bonus-Features (Optional)&lt;/h2&gt;
  &lt;ul&gt;
    &lt;li&gt;[ ] Admin-Panel: Liste aller geladenen CSS-Dateien
  anzeigen&lt;/li&gt;
    &lt;li&gt;[ ] CSS-Editor im Admin-Panel (direkt bearbeiten)&lt;/li&gt;
    &lt;li&gt;[ ] SCSS/SASS-Kompilierung on-the-fly&lt;/li&gt;
    &lt;li&gt;[ ] CSS-Minification&lt;/li&gt;
    &lt;li&gt;[ ] Mehrere Ordner unterst&#xFC;tzen
  (&lt;code&gt;assets/custom/css/staff/&lt;/code&gt;,
  &lt;code&gt;assets/custom/css/client/&lt;/code&gt;)&lt;/li&gt;
  &lt;/ul&gt;

  &lt;hr&gt;

  &lt;h2&gt;Technologie-Stack&lt;/h2&gt;
  &lt;ul&gt;
    &lt;li&gt;osTicket Plugin API&lt;/li&gt;
    &lt;li&gt;PHP File I/O (&lt;code&gt;glob()&lt;/code&gt;,
  &lt;code&gt;filemtime()&lt;/code&gt;, &lt;code&gt;mkdir()&lt;/code&gt;)&lt;/li&gt;
    &lt;li&gt;&lt;code&gt;$ost-&amp;gt;addExtraHeader()&lt;/code&gt; Methode&lt;/li&gt;
    &lt;li&gt;CSS3&lt;/li&gt;
  &lt;/ul&gt;

  &lt;hr&gt;

  &lt;h2&gt;Technische Implementation Details (Code-Analyse)&lt;/h2&gt;

  &lt;h3&gt;1. Header-Injection Mechanismus&lt;/h3&gt;

  &lt;p&gt;&lt;strong&gt;osTicket bietet &lt;code&gt;addExtraHeader()&lt;/code&gt;
  Methode:&lt;/strong&gt;&lt;/p&gt;

  &lt;p&gt;&lt;strong&gt;Klasse:&lt;/strong&gt;
  &lt;code&gt;/include/class.osticket.php&lt;/code&gt; (Zeilen 157-167)&lt;/p&gt;

  &lt;pre&gt;
  // Zeile 157
  function addExtraHeader($header, $pjax_script=false) {
      $this-&amp;gt;headers[md5($header)] = $header;
      $this-&amp;gt;pjax_extra[md5($header)] = $pjax_script;
  }

  // Zeile 162
  function getExtraHeaders() {
      return $this-&amp;gt;headers;
  }
  &lt;/pre&gt;

  &lt;p&gt;&lt;strong&gt;Verwendung in header.inc.php:&lt;/strong&gt;&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;Staff Header:&lt;/strong&gt;
  &lt;code&gt;/include/staff/header.inc.php&lt;/code&gt; (Zeilen 58-60)&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Client Header:&lt;/strong&gt;
  &lt;code&gt;/include/client/header.inc.php&lt;/code&gt; (Zeilen 66-68)&lt;/li&gt;
  &lt;/ul&gt;

  &lt;pre&gt;
  // Beide Header-Dateien verwenden:
  &amp;lt;?php
  if($ost &amp;amp;&amp;amp; ($headers=$ost-&amp;gt;getExtraHeaders())) {
      echo "\n\t".implode("\n\t", $headers)."\n";
  }
  ?&amp;gt;
  &lt;/pre&gt;

  &lt;p&gt;&lt;strong&gt;Injection erfolgt INNERHALB des
  &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; Tags!&lt;/strong&gt;&lt;/p&gt;

  &lt;hr&gt;

  &lt;h3&gt;2. Signal-Hooks f&#xFC;r Context-Detection&lt;/h3&gt;

  &lt;p&gt;&lt;strong&gt;Verf&#xFC;gbare Signals:&lt;/strong&gt;&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;strong&gt;Staff Control Panel:&lt;/strong&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;code&gt;Signal::send('apps.scp', $dispatcher)&lt;/code&gt; in
  &lt;code&gt;/scp/apps/dispatcher.php:39&lt;/code&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Client Portal:&lt;/strong&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;code&gt;Signal::send('ajax.client', $dispatcher)&lt;/code&gt;
  in &lt;code&gt;/ajax.php:50&lt;/code&gt;&lt;/li&gt;
        &lt;li&gt;Alternativ: Bootstrap-Check auf
  &lt;code&gt;OSTCLIENTINC&lt;/code&gt; define&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;&lt;strong&gt;Empfohlene Implementation:&lt;/strong&gt;&lt;/p&gt;

  &lt;pre&gt;
  class CustomCssLoaderPlugin extends Plugin {

      function bootstrap() {
          global $ost;

          // Ordner erstellen
          $this-&amp;gt;ensureCssDirectory();

          // CSS f&#xFC;r Staff Panel
          Signal::connect('apps.scp', function() use ($ost) {
              $this-&amp;gt;injectCss('staff', $ost);
          });

          // CSS f&#xFC;r Client Portal (via define-Check)
          if (defined('OSTCLIENTINC')) {
              $this-&amp;gt;injectCss('client', $ost);
          }
      }

      function injectCss($context, $ost) {
          $cssDir = ROOT_PATH . 'assets/custom/css/';
          $pattern = $cssDir . '*' . $context . '*.css';
          $cssFiles = glob($pattern);

          if (!$cssFiles) return; // Guard: keine Dateien

          foreach ($cssFiles as $file) {
              $version = filemtime($file);
              $url = ROOT_PATH . 'assets/custom/css/' .
  basename($file);
              $ost-&amp;gt;addExtraHeader(
                  sprintf('&amp;lt;link rel="stylesheet"
  href="%s?v=%s" /&amp;gt;',
                      $url, $version)
              );
          }
      }
  }
  &lt;/pre&gt;

  &lt;hr&gt;

  &lt;h3&gt;3. Ordner-Struktur &amp;amp; Berechtigungen&lt;/h3&gt;

  &lt;p&gt;&lt;strong&gt;Ordner-Erstellung:&lt;/strong&gt;&lt;/p&gt;

  &lt;pre&gt;
  function ensureCssDirectory() {
      $cssDir = ROOT_PATH . 'assets/custom/css/';

      if (!is_dir($cssDir)) {
          if (!mkdir($cssDir, 0755, true)) {
              error_log('CustomCssLoader: Failed to create
  directory ' . $cssDir);
              return false;
          }
      }

      // Optional: .htaccess f&#xFC;r direkten CSS-Zugriff
      $htaccess = $cssDir . '.htaccess';
      if (!file_exists($htaccess)) {
          file_put_contents($htaccess, "Allow from all\n");
      }

      return true;
  }
  &lt;/pre&gt;

  &lt;p&gt;&lt;strong&gt;Wichtig:&lt;/strong&gt; Ordner
  &lt;code&gt;assets/custom/css/&lt;/code&gt; muss vom Webserver lesbar
  sein!&lt;/p&gt;

  &lt;hr&gt;

  &lt;h3&gt;4. Dateinamen-Pattern Matching&lt;/h3&gt;

  &lt;p&gt;&lt;strong&gt;Verwendete PHP-Funktionen:&lt;/strong&gt;&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;&lt;code&gt;glob($pattern)&lt;/code&gt; - Findet alle Dateien nach
  Muster&lt;/li&gt;
    &lt;li&gt;&lt;code&gt;filemtime($file)&lt;/code&gt; - Modification Time f&#xFC;r
  Cache-Busting&lt;/li&gt;
    &lt;li&gt;&lt;code&gt;basename($file)&lt;/code&gt; - Dateiname ohne Pfad&lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;&lt;strong&gt;Pattern-Beispiele:&lt;/strong&gt;&lt;/p&gt;

  &lt;pre&gt;
  // Alle Staff-CSS-Dateien
  glob('assets/custom/css/*staff*.css')
  &#x2192; staff-branding.css, my-staff-theme.css, custom-staff.css

  // Alle Client-CSS-Dateien
  glob('assets/custom/css/*client*.css')
  &#x2192; client-styles.css, my-client-theme.css, custom-client.css

  // Alle CSS-Dateien (f&#xFC;r Admin-&#xDC;bersicht)
  glob('assets/custom/css/*.css')
  &lt;/pre&gt;

  &lt;hr&gt;

  &lt;h3&gt;5. Cache-Busting Strategie&lt;/h3&gt;

  &lt;p&gt;&lt;strong&gt;Methode 1: File Modification Time
  (empfohlen)&lt;/strong&gt;&lt;/p&gt;

  &lt;pre&gt;
  $version = filemtime($file); // Unix Timestamp
  $url = sprintf('%s?v=%d', $cssUrl, $version);
  // Beispiel: assets/custom/css/staff-theme.css?v=1738261234
  &lt;/pre&gt;

  &lt;p&gt;&lt;strong&gt;Methode 2: MD5 Hash (alternative)&lt;/strong&gt;&lt;/p&gt;

  &lt;pre&gt;
  $hash = md5_file($file);
  $url = sprintf('%s?v=%s', $cssUrl, substr($hash, 0, 8));
  // Beispiel: assets/custom/css/staff-theme.css?v=a3f2c1d4
  &lt;/pre&gt;

  &lt;p&gt;&lt;strong&gt;Browser-Verhalten:&lt;/strong&gt;&lt;/p&gt;
  &lt;ul&gt;
    &lt;li&gt;&#xC4;ndert sich &lt;code&gt;?v=&lt;/code&gt; Parameter &#x2192; Browser l&#xE4;dt
  Datei neu&lt;/li&gt;
    &lt;li&gt;Gleicher Parameter &#x2192; Browser nutzt Cache&lt;/li&gt;
  &lt;/ul&gt;

  &lt;hr&gt;

  &lt;h3&gt;6. Error Handling &amp;amp; Logging&lt;/h3&gt;

  &lt;pre&gt;
  function injectCss($context, $ost) {
      try {
          $cssDir = ROOT_PATH . 'assets/custom/css/';

          // Guard: Verzeichnis existiert nicht
          if (!is_dir($cssDir)) {
              error_log("CustomCssLoader: Directory not found:
  $cssDir");
              return;
          }

          // Guard: Keine Leserechte
          if (!is_readable($cssDir)) {
              error_log("CustomCssLoader: Directory not readable:
  $cssDir");
              return;
          }

          $cssFiles = glob($cssDir . '*' . $context . '*.css');

          // Guard: Keine Dateien gefunden (kein Error - einfach
  nichts tun)
          if (!$cssFiles) return;

          foreach ($cssFiles as $file) {
              // Guard: Datei nicht lesbar
              if (!is_readable($file)) {
                  error_log("CustomCssLoader: File not readable:
  $file");
                  continue;
              }

              $version = filemtime($file);
              $url = ROOT_PATH . 'assets/custom/css/' .
  basename($file);
              $ost-&amp;gt;addExtraHeader(
                  sprintf('&amp;lt;link rel="stylesheet"
  href="%s?v=%s" /&amp;gt;', $url, $version)
              );
          }
      } catch (Exception $e) {
          error_log("CustomCssLoader Exception: " .
  $e-&amp;gt;getMessage());
      }
  }
  &lt;/pre&gt;

  &lt;hr&gt;

  &lt;h3&gt;7. Plugin-Installation Workflow&lt;/h3&gt;

  &lt;ol&gt;
    &lt;li&gt;&lt;strong&gt;Plugin installieren:&lt;/strong&gt; Ordner nach
  &lt;code&gt;include/plugins/custom-css-loader/&lt;/code&gt; kopieren&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Plugin aktivieren:&lt;/strong&gt; Admin Panel &#x2192; Manage &#x2192;
   Plugins &#x2192; "Custom CSS Loader" aktivieren&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Ordner wird erstellt:&lt;/strong&gt;
  &lt;code&gt;assets/custom/css/&lt;/code&gt; entsteht automatisch&lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;CSS-Dateien hinzuf&#xFC;gen:&lt;/strong&gt;
      &lt;ul&gt;
        &lt;li&gt;Kopiere &lt;code&gt;staff-branding.css&lt;/code&gt; nach
  &lt;code&gt;assets/custom/css/&lt;/code&gt;&lt;/li&gt;
        &lt;li&gt;Kopiere &lt;code&gt;client-branding.css&lt;/code&gt; nach
  &lt;code&gt;assets/custom/css/&lt;/code&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;strong&gt;Browser-Reload:&lt;/strong&gt; CSS wird automatisch
  geladen!&lt;/li&gt;
  &lt;/ol&gt;

  &lt;hr&gt;

  &lt;h3&gt;8. Testing-Checkliste&lt;/h3&gt;

  &lt;ul&gt;
    &lt;li&gt;[ ] Plugin aktivieren &#x2192; &lt;code&gt;assets/custom/css/&lt;/code&gt;
  Ordner wird erstellt&lt;/li&gt;
    &lt;li&gt;[ ] &lt;code&gt;staff-test.css&lt;/code&gt; in Ordner legen &#x2192; Im Admin
   Panel &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; sichtbar&lt;/li&gt;
    &lt;li&gt;[ ] &lt;code&gt;client-test.css&lt;/code&gt; in Ordner legen &#x2192; Im
  Client Portal &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; sichtbar&lt;/li&gt;
    &lt;li&gt;[ ] CSS-Datei &#xE4;ndern &#x2192; Cache-Busting Parameter &#xE4;ndert
  sich&lt;/li&gt;
    &lt;li&gt;[ ] Leerer Ordner &#x2192; Keine Fehler im Log&lt;/li&gt;
    &lt;li&gt;[ ] Plugin deaktivieren &#x2192; CSS wird NICHT mehr geladen&lt;/li&gt;
    &lt;li&gt;[ ] Ung&#xFC;ltige Datei (keine .css) &#x2192; Wird ignoriert&lt;/li&gt;
    &lt;li&gt;[ ] Browser DevTools: CSS wird korrekt angewendet&lt;/li&gt;
  &lt;/ul&gt;

  &lt;hr&gt;

  &lt;p&gt;&lt;em&gt;Recherchiert in:&lt;/em&gt;
  &lt;code&gt;/home/markus/projekte/osTicket&lt;/code&gt; (osTicket
  1.18.1)&lt;/p&gt;</body></item></thread></ticket>


[0;32m[TEST][0m 1.3 Get Non-Existent Ticket (404 Error)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-get.php/999999.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
Ticket not found
HTTP Status: 404



[0;34m===================================================================[0m
[0;34m  2. LEGACY ENDPOINTS - tickets-search.php[0m
[0;34m===================================================================[0m

[0;32m[TEST][0m 2.1 Search Tickets by Query
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-search.php?query=test&limit=10"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | jq .

[1;33mResponse:[0m
[
  {
    "id": 67,
    "number": "469861",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 17:22:00",
    "updated": "2025-11-07 17:22:00",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 66,
    "number": "155274",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 17:21:58",
    "updated": "2025-11-07 17:21:58",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 65,
    "number": "197101",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 17:21:54",
    "updated": "2025-11-07 17:21:54",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 63,
    "number": "432791",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 14:17:43",
    "updated": "2025-11-07 14:17:43",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 61,
    "number": "698266",
    "subject": "TEST Child",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 1,
    "priority": "Niedrig",
    "departmentId": 1,
    "department": "Support",
    "topicId": 2,
    "topic": "Feedback",
    "created": "2025-11-03 14:38:31",
    "updated": "2025-11-03 14:38:31",
    "dueDate": "2025-12-31 14:37:00",
    "staffId": 1,
    "staff": {
      "format": "full",
      "parts": {
        "first": "Markus",
        "last": "Michalski"
      },
      "name": "Markus Michalski"
    },
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 36,
    "number": "240077",
    "subject": "Update-Test: PATCH-Endpoint",
    "statusId": 3,
    "status": "Geschlossen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 2,
    "department": "Development",
    "topicId": 1,
    "topic": "Feature",
    "created": "2025-10-25 12:06:29",
    "updated": "2025-10-25 12:06:38",
    "dueDate": null,
    "staffId": 1,
    "staff": {
      "format": "full",
      "parts": {
        "first": "Markus",
        "last": "Michalski"
      },
      "name": "Markus Michalski"
    },
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 33,
    "number": "219489",
    "subject": "Update-Test nach Priority-Fix",
    "statusId": 3,
    "status": "Geschlossen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 2,
    "department": "Development",
    "topicId": 1,
    "topic": "Feature",
    "created": "2025-10-24 18:50:54",
    "updated": "2025-10-24 18:51:30",
    "dueDate": null,
    "staffId": 1,
    "staff": {
      "format": "full",
      "parts": {
        "first": "Markus",
        "last": "Michalski"
      },
      "name": "Markus Michalski"
    },
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  }
]


[0;32m[TEST][0m 2.2 Search Tickets with Status Filter
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-search.php?status=Open&limit=5"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | jq .

[1;33mResponse:[0m
[
  {
    "id": 67,
    "number": "469861",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 17:22:00",
    "updated": "2025-11-07 17:22:00",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 66,
    "number": "155274",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 17:21:58",
    "updated": "2025-11-07 17:21:58",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 65,
    "number": "197101",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 17:21:54",
    "updated": "2025-11-07 17:21:54",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 63,
    "number": "432791",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 14:17:43",
    "updated": "2025-11-07 14:17:43",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 61,
    "number": "698266",
    "subject": "TEST Child",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 1,
    "priority": "Niedrig",
    "departmentId": 1,
    "department": "Support",
    "topicId": 2,
    "topic": "Feedback",
    "created": "2025-11-03 14:38:31",
    "updated": "2025-11-03 14:38:31",
    "dueDate": "2025-12-31 14:37:00",
    "staffId": 1,
    "staff": {
      "format": "full",
      "parts": {
        "first": "Markus",
        "last": "Michalski"
      },
      "name": "Markus Michalski"
    },
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  }
]


[0;32m[TEST][0m 2.3 Search Tickets with Department Filter
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-search.php?department=Support&limit=5"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | jq .

[1;33mResponse:[0m
[
  {
    "id": 67,
    "number": "469861",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 17:22:00",
    "updated": "2025-11-07 17:22:00",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 66,
    "number": "155274",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 17:21:58",
    "updated": "2025-11-07 17:21:58",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 65,
    "number": "197101",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 17:21:54",
    "updated": "2025-11-07 17:21:54",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 63,
    "number": "432791",
    "subject": "Test Ticket",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 1,
    "department": "Support",
    "topicId": null,
    "topic": null,
    "created": "2025-11-07 14:17:43",
    "updated": "2025-11-07 14:17:43",
    "dueDate": null,
    "staffId": null,
    "staff": null,
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  },
  {
    "id": 61,
    "number": "698266",
    "subject": "TEST Child",
    "statusId": 1,
    "status": "Offen",
    "priorityId": 1,
    "priority": "Niedrig",
    "departmentId": 1,
    "department": "Support",
    "topicId": 2,
    "topic": "Feedback",
    "created": "2025-11-03 14:38:31",
    "updated": "2025-11-03 14:38:31",
    "dueDate": "2025-12-31 14:37:00",
    "staffId": 1,
    "staff": {
      "format": "full",
      "parts": {
        "first": "Markus",
        "last": "Michalski"
      },
      "name": "Markus Michalski"
    },
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  }
]


[0;32m[TEST][0m 2.4 Search Tickets with Pagination
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-search.php?query=bug&limit=10&offset=0"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | jq .

[1;33mResponse:[0m
[
  {
    "id": 24,
    "number": "896050",
    "subject": "Bug: Wildcard-API ignoriert departmentId bei Ticket-Erstellung",
    "statusId": 3,
    "status": "Geschlossen",
    "priorityId": 2,
    "priority": "Normal",
    "departmentId": 9,
    "department": "osTicket",
    "topicId": 10,
    "topic": "Softwarebug",
    "created": "2025-10-19 21:43:18",
    "updated": "2025-10-19 22:06:25",
    "dueDate": null,
    "staffId": 1,
    "staff": {
      "format": "full",
      "parts": {
        "first": "Markus",
        "last": "Michalski"
      },
      "name": "Markus Michalski"
    },
    "teamId": null,
    "team": null,
    "slaId": 1,
    "sla": "Standard-SLA",
    "isOverdue": 0,
    "isAnswered": 0
  }
]


[0;32m[TEST][0m 2.5 Search Tickets (XML format)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-search.php/.xml?query=test&limit=5"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s

[1;33mResponse:[0m
<?xml version="1.0"?>
<result><tickets><item><id>67</id><number>469861</number><subject>Test Ticket</subject><statusId>1</statusId><status>Offen</status><priorityId>2</priorityId><priority>Normal</priority><departmentId>1</departmentId><department>Support</department><topicId/><topic/><created>2025-11-07 17:22:00</created><updated>2025-11-07 17:22:00</updated><dueDate/><staffId/><staff/><teamId/><team/><slaId>1</slaId><sla>Standard-SLA</sla><isOverdue>0</isOverdue><isAnswered>0</isAnswered></item><item><id>66</id><number>155274</number><subject>Test Ticket</subject><statusId>1</statusId><status>Offen</status><priorityId>2</priorityId><priority>Normal</priority><departmentId>1</departmentId><department>Support</department><topicId/><topic/><created>2025-11-07 17:21:58</created><updated>2025-11-07 17:21:58</updated><dueDate/><staffId/><staff/><teamId/><team/><slaId>1</slaId><sla>Standard-SLA</sla><isOverdue>0</isOverdue><isAnswered>0</isAnswered></item><item><id>65</id><number>197101</number><subject>Test Ticket</subject><statusId>1</statusId><status>Offen</status><priorityId>2</priorityId><priority>Normal</priority><departmentId>1</departmentId><department>Support</department><topicId/><topic/><created>2025-11-07 17:21:54</created><updated>2025-11-07 17:21:54</updated><dueDate/><staffId/><staff/><teamId/><team/><slaId>1</slaId><sla>Standard-SLA</sla><isOverdue>0</isOverdue><isAnswered>0</isAnswered></item><item><id>63</id><number>432791</number><subject>Test Ticket</subject><statusId>1</statusId><status>Offen</status><priorityId>2</priorityId><priority>Normal</priority><departmentId>1</departmentId><department>Support</department><topicId/><topic/><created>2025-11-07 14:17:43</created><updated>2025-11-07 14:17:43</updated><dueDate/><staffId/><staff/><teamId/><team/><slaId>1</slaId><sla>Standard-SLA</sla><isOverdue>0</isOverdue><isAnswered>0</isAnswered></item><item><id>61</id><number>698266</number><subject>TEST Child</subject><statusId>1</statusId><status>Offen</status><priorityId>1</priorityId><priority>Niedrig</priority><departmentId>1</departmentId><department>Support</department><topicId>2</topicId><topic>Feedback</topic><created>2025-11-03 14:38:31</created><updated>2025-11-03 14:38:31</updated><dueDate>2025-12-31 14:37:00</dueDate><staffId>1</staffId><staff>Markus Michalski</staff><teamId/><team/><slaId>1</slaId><sla>Standard-SLA</sla><isOverdue>0</isOverdue><isAnswered>0</isAnswered></item></tickets></result>



[0;34m===================================================================[0m
[0;34m  3. LEGACY ENDPOINTS - tickets-update.php[0m
[0;34m===================================================================[0m

[0;32m[TEST][0m 3.1 Update Ticket Status
[1;33mCommand:[0m
curl -X PATCH "https://stage.tickets.markus-michalski.net/api/tickets-update.php/237948.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -H "Content-Type: application/json"   -d '{"statusId": 3}'   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
237948
HTTP Status: 200


[0;32m[TEST][0m 3.2 Update Ticket Department
[1;33mCommand:[0m
curl -X PATCH "https://stage.tickets.markus-michalski.net/api/tickets-update.php/237948.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -H "Content-Type: application/json"   -d '{"departmentId": "Support"}'   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
237948
HTTP Status: 200


[0;32m[TEST][0m 3.3 Update Ticket Topic (Help Topic)
[1;33mCommand:[0m
curl -X PATCH "https://stage.tickets.markus-michalski.net/api/tickets-update.php/237948.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -H "Content-Type: application/json"   -d '{"topicId": 2}'   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
237948
HTTP Status: 200


[0;32m[TEST][0m 3.4 Update Multiple Properties Simultaneously
[1;33mCommand:[0m
curl -X PATCH "https://stage.tickets.markus-michalski.net/api/tickets-update.php/237948.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -H "Content-Type: application/json"   -d '{"statusId": 1, "departmentId": 2, "topicId": 3}'   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
Help Topic not found
HTTP Status: 404


[0;32m[TEST][0m 3.5 Update with Invalid JSON (400 Error)
[1;33mCommand:[0m
curl -X PATCH "https://stage.tickets.markus-michalski.net/api/tickets-update.php/237948.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -H "Content-Type: application/json"   -d '{"statusId": INVALID}'   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
{"error":true,"message":"Invalid JSON: Syntax error"}
HTTP Status: 400


[0;32m[TEST][0m 3.6 Update with Wrong HTTP Method (405 Error)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-update.php/237948.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
Method Not Allowed. Use PATCH or PUT
HTTP Status: 405



[0;34m===================================================================[0m
[0;34m  4. LEGACY ENDPOINTS - tickets-stats.php[0m
[0;34m===================================================================[0m

[0;32m[TEST][0m 4.1 Get Ticket Statistics (JSON)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-stats.php/.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | jq .

[1;33mResponse:[0m
{
  "total": 45,
  "open": 33,
  "closed": 12,
  "overdue": 24,
  "by_department": {
    "Claude Code": {
      "total": 1,
      "open": 0,
      "closed": 1,
      "overdue": 0
    },
    "Development": {
      "total": 4,
      "open": 0,
      "closed": 4,
      "overdue": 0
    },
    "Support": {
      "total": 28,
      "open": 28,
      "closed": 0,
      "overdue": 23
    },
    "osTicket": {
      "total": 12,
      "open": 5,
      "closed": 7,
      "overdue": 1
    }
  },
  "by_staff": [
    {
      "staff_id": 1,
      "staff_name": {
        "format": "full",
        "parts": {
          "first": "Markus",
          "last": "Michalski"
        },
        "name": "Markus Michalski"
      },
      "total": 41,
      "departments": {
        "osTicket": {
          "open": 5,
          "closed": 7,
          "overdue": 1
        },
        "Support": {
          "open": 24,
          "closed": 0,
          "overdue": 23
        },
        "Claude Code": {
          "open": 0,
          "closed": 1,
          "overdue": 0
        },
        "Development": {
          "open": 0,
          "closed": 4,
          "overdue": 0
        }
      }
    }
  ]
}


[0;32m[TEST][0m 4.2 Get Ticket Statistics (XML)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-stats.php/.xml"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s

[1;33mResponse:[0m
<?xml version="1.0"?>
<stats><total>45</total><open>33</open><closed>12</closed><overdue>24</overdue><by_department><Claude Code><total>1</total><open>0</open><closed>1</closed><overdue>0</overdue></Claude Code><Development><total>4</total><open>0</open><closed>4</closed><overdue>0</overdue></Development><Support><total>28</total><open>28</open><closed>0</closed><overdue>23</overdue></Support><osTicket><total>12</total><open>5</open><closed>7</closed><overdue>1</overdue></osTicket></by_department><by_staff><item><staff_id>1</staff_id><staff_name>Markus Michalski</staff_name><total>41</total><departments><osTicket><open>5</open><closed>7</closed><overdue>1</overdue></osTicket><Support><open>24</open><closed>0</closed><overdue>23</overdue></Support><Claude Code><open>0</open><closed>1</closed><overdue>0</overdue></Claude Code><Development><open>0</open><closed>4</closed><overdue>0</overdue></Development></departments></item></by_staff></stats>



[0;34m===================================================================[0m
[0;34m  5. LEGACY ENDPOINTS - tickets-statuses.php[0m
[0;34m===================================================================[0m

[0;32m[TEST][0m 5.1 Get All Ticket Statuses (JSON)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-statuses.php/.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | jq .

[1;33mResponse:[0m
[
  {
    "id": 1,
    "name": "Offen",
    "state": "open"
  },
  {
    "id": 6,
    "name": "In Bearbeitung",
    "state": "open"
  },
  {
    "id": 8,
    "name": "Wartet auf Antwort",
    "state": "open"
  },
  {
    "id": 7,
    "name": "Pausiert",
    "state": "open"
  },
  {
    "id": 9,
    "name": "Testing",
    "state": "open"
  },
  {
    "id": 2,
    "name": "GelÃ¶st",
    "state": "closed"
  },
  {
    "id": 3,
    "name": "Geschlossen",
    "state": "closed"
  },
  {
    "id": 4,
    "name": "Archiviert",
    "state": "archived"
  },
  {
    "id": 5,
    "name": "GelÃ¶scht",
    "state": "deleted"
  }
]


[0;32m[TEST][0m 5.2 Get All Ticket Statuses (XML)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-statuses.php/.xml"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s

[1;33mResponse:[0m
<?xml version="1.0"?>
<result><statuses><item><id>1</id><name>Offen</name><state>open</state></item><item><id>6</id><name>In Bearbeitung</name><state>open</state></item><item><id>8</id><name>Wartet auf Antwort</name><state>open</state></item><item><id>7</id><name>Pausiert</name><state>open</state></item><item><id>9</id><name>Testing</name><state>open</state></item><item><id>2</id><name>Gel&#xF6;st</name><state>closed</state></item><item><id>3</id><name>Geschlossen</name><state>closed</state></item><item><id>4</id><name>Archiviert</name><state>archived</state></item><item><id>5</id><name>Gel&#xF6;scht</name><state>deleted</state></item></statuses></result>



[0;34m===================================================================[0m
[0;34m  6. LEGACY ENDPOINTS - tickets-delete.php[0m
[0;34m===================================================================[0m

[0;31mWARNING: This will DELETE ticket 469861![0m
[0;32m[TEST][0m 6.1 Delete Ticket
[1;33mCommand:[0m
curl -X DELETE "https://stage.tickets.markus-michalski.net/api/tickets-delete.php/469861.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
469861
HTTP Status: 200


[0;32m[TEST][0m 6.2 Delete Non-Existent Ticket (404 Error)
[1;33mCommand:[0m
curl -X DELETE "https://stage.tickets.markus-michalski.net/api/tickets-delete.php/999999.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
Ticket not found
HTTP Status: 404



[0;34m===================================================================[0m
[0;34m  7. SUBTICKET ENDPOINTS - tickets-subtickets-parent.php[0m
[0;34m===================================================================[0m

[0;32m[TEST][0m 7.1 Get Parent Ticket (JSON)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-parent.php/237948.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | jq .

[1;33mResponse:[0m
{
  "parent": null
}


[0;32m[TEST][0m 7.2 Get Parent Ticket (XML)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-parent.php/237948.xml"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s

[1;33mResponse:[0m
<?xml version="1.0"?>
<response><parent/></response>


[0;32m[TEST][0m 7.3 Get Parent of Ticket Without Parent (404 Error)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-parent.php/456846.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
{"parent":null}
HTTP Status: 200



[0;34m===================================================================[0m
[0;34m  8. SUBTICKET ENDPOINTS - tickets-subtickets-list.php[0m
[0;34m===================================================================[0m

[0;32m[TEST][0m 8.1 Get List of Child Tickets (JSON)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-list.php/456846.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | jq .

[1;33mResponse:[0m
{
  "children": []
}


[0;32m[TEST][0m 8.2 Get List of Child Tickets (XML)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-list.php/456846.xml"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s

[1;33mResponse:[0m
<?xml version="1.0"?>
<response><children/></response>


[0;32m[TEST][0m 8.3 Get Children of Ticket Without Children (Empty Array)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-list.php/237948.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | jq .

[1;33mResponse:[0m
{
  "children": []
}



[0;34m===================================================================[0m
[0;34m  9. SUBTICKET ENDPOINTS - tickets-subtickets-create.php[0m
[0;34m===================================================================[0m

[0;32m[TEST][0m 9.1 Create Subticket Link
[1;33mCommand:[0m
curl -X POST "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-create.php/456846.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -H "Content-Type: application/json"   -d '{"childId": 237948}'   -s | jq .

[1;33mResponse:[0m
{
  "success": true,
  "message": "Subticket relationship created successfully",
  "parent": {
    "ticket_id": 22,
    "number": "456846",
    "subject": "Plugin: Custom CSS Loader",
    "status": "Offen"
  },
  "child": {
    "ticket_id": 20,
    "number": "237948",
    "subject": "Plugin: Priority Icons (CSS/JS injection via Signals)",
    "status": "Geschlossen"
  }
}


[0;32m[TEST][0m 9.2 Create Subticket Link (Already Linked - 409 Error)
[1;33mCommand:[0m
curl -X POST "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-create.php/456846.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -H "Content-Type: application/json"   -d '{"childId": 237948}'   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
{"success":true,"message":"Subticket relationship created successfully","parent":{"ticket_id":22,"number":"456846","subject":"Plugin: Custom CSS Loader","status":"Offen"},"child":{"ticket_id":20,"number":"237948","subject":"Plugin: Priority Icons (CSS\/JS injection via Signals)","status":"Geschlossen"}}
HTTP Status: 200


[0;32m[TEST][0m 9.3 Create Subticket Link with Missing childId (400 Error)
[1;33mCommand:[0m
curl -X POST "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-create.php/456846.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -H "Content-Type: application/json"   -d '{}'   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
Missing childId in request body
HTTP Status: 400


[0;32m[TEST][0m 9.4 Create Subticket Link with Non-Existent Parent (404 Error)
[1;33mCommand:[0m
curl -X POST "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-create.php/999999.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -H "Content-Type: application/json"   -d '{"childId": 237948}'   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
Parent ticket not found
HTTP Status: 404


[0;32m[TEST][0m 9.5 Create Subticket Link with Non-Existent Child (404 Error)
[1;33mCommand:[0m
curl -X POST "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-create.php/456846.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -H "Content-Type: application/json"   -d '{"childId": 999999}'   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
Child ticket not found
HTTP Status: 404



[0;34m===================================================================[0m
[0;34m  10. SUBTICKET ENDPOINTS - tickets-subtickets-unlink.php[0m
[0;34m===================================================================[0m

[0;32m[TEST][0m 10.1 Unlink Subticket
[1;33mCommand:[0m
curl -X DELETE "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-unlink.php/237948.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | jq .

[1;33mResponse:[0m


[0;32m[TEST][0m 10.2 Unlink Subticket (Already Unlinked - 404 Error)
[1;33mCommand:[0m
curl -X DELETE "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-unlink.php/237948.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
Child has no parent to unlink
HTTP Status: 404


[0;32m[TEST][0m 10.3 Unlink Non-Existent Ticket (404 Error)
[1;33mCommand:[0m
curl -X DELETE "https://stage.tickets.markus-michalski.net/api/tickets-subtickets-unlink.php/999999.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
Child ticket not found
HTTP Status: 404



[0;34m===================================================================[0m
[0;34m  11. SECURITY TESTS (Should Fail)[0m
[0;34m===================================================================[0m

[0;32m[TEST][0m 11.1 Test XXE Protection (XML External Entity Attack)
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-get.php/456846.xml"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s | grep -q '<!DOCTYPE' && echo 'VULNERABLE: XXE possible!' || echo 'SAFE: No DOCTYPE in response'

[1;33mResponse:[0m
SAFE: No DOCTYPE in response


[0;32m[TEST][0m 11.2 Test JSON Bomb Protection (Deep Nesting)
[1;33mCommand:[0m
curl -X PATCH "https://stage.tickets.markus-michalski.net/api/tickets-update.php/237948.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -H "Content-Type: application/json"   -d '{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{{}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}'   -s -w "\nHTTP Status: %{http_code}\n"

[1;33mResponse:[0m
{"error":true,"message":"Invalid JSON: Syntax error"}
HTTP Status: 400


[0;32m[TEST][0m 11.3 Test Invalid HTTP Status Code Injection
[1;33mCommand:[0m
curl -X GET "https://stage.tickets.markus-michalski.net/api/tickets-get.php/INVALID_TICKET.json"   -H "X-API-Key: CE206076F0B32E58AB3EBBF8CBD2DD29"   -s -w "\nHTTP Status: %{http_code}\n" | grep -q '^[1-5][0-9][0-9]$' && echo 'SAFE: Valid HTTP status' || echo 'VULNERABLE: Invalid HTTP status'

[1;33mResponse:[0m
VULNERABLE: Invalid HTTP status



[0;34m===================================================================[0m
[0;34m  TEST SUITE COMPLETED[0m
[0;34m===================================================================[0m

[0;32mAll tests completed![0m
[1;33mNote:[0m Some tests are expected to fail (404, 409, etc.) - this is normal.
[1;33mReview the responses above to verify correct behavior.[0m
